<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Rakrao Admin Dashboard</title>
</head>
<body style="background-color: #1e1e1e; color: #e0e0e0; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex;">
    <div style="width: 260px; background-color: #252526; height: 100vh; position: fixed; border-right: 1px solid #333; display: flex; flex-direction: column;">
        <div style="padding: 30px 20px;">
            <h2 style="color: #4caf50; margin: 0;">üåø RAKRAO</h2>
        </div>
        
        <nav style="flex-grow: 1; padding: 10px;">
            <div onclick="showSection('user')" style="cursor:pointer; padding: 12px 15px; color: #4caf50; background: #2d2d2d; border-radius: 8px; margin-bottom: 5px;">üë§ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
            <div onclick="showSection('inventory')" style="cursor:pointer; padding: 12px 15px; color: #bbb;">üì¶ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
        </nav>

        <div style="padding: 20px; border-top: 1px solid #333;">
            <button onclick="logout()" style="width: 100%; padding: 8px; background: none; border: 1px solid #ff5252; color: #ff5252; border-radius: 5px; cursor: pointer;">Logout</button>
        
        </div>
    </div>

    <div style="margin-left: 260px; padding: 40px; width: 100%;">
        
        <div id="section-user">
            <h1>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å / ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h1>
            <div style="background: #252526; padding: 25px; border-radius: 12px; border: 1px solid #333;">
                <h3>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì, <span style="color: #4caf50;">Admin</span></h3>
                <p>‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏™‡∏ï‡πá‡∏≠‡∏Å: <span id="stat-count">...</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</p>
            </div>
        </div>

        <div id="section-inventory" style="display: none;">
            <h1>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
            
            <div style="background: #252526; padding: 20px; border-radius: 12px; margin-bottom: 30px;">
                <input id="n" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤" style="padding: 10px; border-radius: 5px; border: 1px solid #444; background: #1e1e1e; color: white;">
                <input id="p" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤" style="padding: 10px; border-radius: 5px; border: 1px solid #444; background: #1e1e1e; color: white;">
                <button onclick="add()" style="padding: 10px 20px; background: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer;">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
            </div>

            <div id="list" style="display: grid; gap: 10px;">
                </div> </div>  </div>

    <script>
        if (localStorage.getItem('rakrao_auth') !== 'true') {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Ñ‡∏≠‡∏¥‡∏ô');
        location.href = '/login'; // ‡∏î‡∏µ‡∏î‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Login ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        }

        // üö™ 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Logout: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏ö‡∏±‡∏ï‡∏£‡∏ú‡πà‡∏≤‡∏ô
        function logout() {
        localStorage.removeItem('rakrao_auth');
        location.href = '/'; // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏•‡∏≤‡∏î
        }
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á Sidebar)
        function showSection(name) {
            document.getElementById('section-user').style.display = name === 'user' ? 'block' : 'none';
            document.getElementById('section-inventory').style.display = name === 'inventory' ? 'block' : 'none';
        }
        // 2. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        async function load() {
            const r = await fetch('/api/products');
            const d = await r.json();
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
            document.getElementById('stat-count').innerText = d.length;
            // ‡∏û‡πà‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
            document.getElementById('list').innerHTML = d.map(x => `
               <div style="display: flex; justify-content: space-between; align-items: center; background: #2d2d2d; padding: 15px; border-radius: 8px;">
                    <span>‚úÖ ${x.name}</b> - <span style="color: #4caf50;">${x.price} ‡∏ö‡∏≤‡∏ó</span></span>
                    <div>
                        <button onclick="editProduct(${x.id}, '${x.name}', ${x.price})" style="background: #ffc107; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; margin-right: 5px;">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        <button onclick="deleteProduct(${x.id})" style="background: #f44336; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">‡∏•‡∏ö</button>
                    </div>
                </div>
            `).join('');}
        load();
        async function add() {
            const name = document.getElementById('n').value;
            const price = document.getElementById('p').value;
            if (!n || !p) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
            await fetch('/api/products', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ name, price: Number(price) })
            });
            document.getElementById('n').value = '';
            document.getElementById('p').value = '';
            load();
        }
        async function deleteProduct(id) {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                await fetch(`/api/products/${id}`, { method: 'DELETE' });
                load();
            }
        }
        async function editProduct(id, oldName, oldPrice) {
            const name = prompt("‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà:", oldName);
            const price = prompt("‡∏£‡∏≤‡∏Ñ‡∏≤‡πÉ‡∏´‡∏°‡πà:", oldPrice);
            if (name && price) {
                await fetch(`/api/products/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, price: Number(price) })
                });
                load();
            }
        }
    </script>  </body>  </html>
